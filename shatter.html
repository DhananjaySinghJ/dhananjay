<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Text Shatter Effect</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/matter-js/0.19.0/matter.min.js"></script>
    <style>
        body {
            margin: 0;
            min-height: 300vh;
            background: #000;
            color: #EB4330;
            font-family: system-ui, -apple-system, sans-serif;
            overflow-x: hidden;
        }

        .container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            padding: 2rem;
            box-sizing: border-box;
        }

        .text-container {
            max-width: 800px;
            margin: 0 auto;
            font-size: 1rem;
            line-height: 1.4;
        }

        canvas {
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            pointer-events: none;
            z-index: 1;
        }

        .scroll-guide {
            position: fixed;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            color: #EB4330;
            font-size: 1rem;
            z-index: 2;
        }

        .char-wrapper {
            display: inline-block;
            transform: translate3d(0, 0, 0);
            transition: color 0.3s ease;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="text-container" id="text">
            I'm a Creative Developer with a passion for bringing ideas to life through design and technology. Let's create something amazing together.
        </div>
    </div>
    <div class="scroll-guide">Scroll down to shatter text â†“</div>

    <script>
        class TextShatterEffect {
            constructor() {
                this.engine = Matter.Engine.create({
                    enableSleeping: false,
                    constraintIterations: 4
                });
                
                this.world = this.engine.world;
                this.world.gravity.y = 0.5;

                this.render = Matter.Render.create({
                    element: document.body,
                    engine: this.engine,
                    options: {
                        width: window.innerWidth,
                        height: window.innerHeight,
                        background: 'transparent',
                        wireframes: false,
                        pixelRatio: window.devicePixelRatio
                    }
                });

                this.textElement = document.getElementById('text');
                this.particles = [];
                this.isShattered = false;
                this.lastScrollY = window.scrollY;
                this.scrollVelocity = 0;

                this.init();
                this.addEventListeners();
            }

            init() {
                // Split text into characters
                this.splitText();
                
                // Create ground
                this.ground = Matter.Bodies.rectangle(
                    window.innerWidth / 2,
                    window.innerHeight + 50,
                    window.innerWidth,
                    100,
                    { 
                        isStatic: true,
                        render: { visible: false }
                    }
                );
                Matter.World.add(this.world, this.ground);

                // Start render engine
                Matter.Render.run(this.render);
            }

            splitText() {
                const text = this.textElement.textContent;
                this.textElement.innerHTML = '';
                this.chars = text.split('').map(char => {
                    const span = document.createElement('span');
                    span.className = 'char-wrapper';
                    span.textContent = char;
                    this.textElement.appendChild(span);
                    return span;
                });
            }

            createLetterTexture(char, width, height) {
                const canvas = document.createElement('canvas');
                const ctx = canvas.getContext('2d');
                canvas.width = width * 2;
                canvas.height = height * 2;
                ctx.scale(2, 2);
                ctx.font = `${height}px system-ui`;
                ctx.fillStyle = '#FFFFFF';
                ctx.textAlign = 'center';
                ctx.textBaseline = 'middle';
                ctx.fillText(char, width/2, height/2);
                return canvas.toDataURL();
            }

            createParticles() {
                this.chars.forEach(charElement => {
                    if (charElement.textContent.trim() === '') return;

                    const rect = charElement.getBoundingClientRect();
                    const body = Matter.Bodies.rectangle(
                        rect.left + rect.width/2,
                        rect.top + rect.height/2,
                        rect.width,
                        rect.height,
                        {
                            restitution: 0.8 + Math.random() * 0.2,
                            friction: 0.2,
                            frictionAir: 0.002,
                            render: {
                                sprite: {
                                    texture: this.createLetterTexture(
                                        charElement.textContent,
                                        rect.width,
                                        rect.height
                                    )
                                }
                            }
                        }
                    );

                    Matter.World.add(this.world, body);
                    this.particles.push({
                        body,
                        element: charElement,
                        originalPosition: {
                            x: rect.left + rect.width/2,
                            y: rect.top + rect.height/2
                        }
                    });
                });

                Matter.Engine.run(this.engine);
            }

            cleanupParticles() {
                this.particles.forEach(particle => {
                    Matter.World.remove(this.world, particle.body);
                });
                this.particles = [];
            }

            handleScroll = () => {
                const currentScrollY = window.scrollY;
                this.scrollVelocity = currentScrollY - this.lastScrollY;
                this.lastScrollY = currentScrollY;

                const scrollProgress = currentScrollY / (document.documentElement.scrollHeight - window.innerHeight);
                
                if (!this.isShattered && scrollProgress > 0.2) {
                    this.isShattered = true;
                    this.createParticles();
                    this.textElement.style.opacity = 0;
                } else if (this.isShattered && scrollProgress < 0.2) {
                    this.isShattered = false;
                    this.cleanupParticles();
                    this.textElement.style.opacity = 1;
                }

                if (this.isShattered) {
                    const force = this.scrollVelocity * 0.0001;
                    this.particles.forEach(particle => {
                        Matter.Body.applyForce(particle.body, particle.body.position, {
                            x: force * (Math.random() - 0.5),
                            y: force * (Math.random() - 0.5)
                        });
                    });
                }
            }

            addEventListeners() {
                window.addEventListener('scroll', this.handleScroll);
                window.addEventListener('resize', () => {
                    this.render.canvas.width = window.innerWidth;
                    this.render.canvas.height = window.innerHeight;
                    if (this.isShattered) {
                        this.cleanupParticles();
                        this.createParticles();
                    }
                });
            }
        }

        // Initialize the effect when the page loads
        window.addEventListener('load', () => {
            new TextShatterEffect();
        });
    </script>
</body>
</html>